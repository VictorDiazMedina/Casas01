<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Casas</title>
    <meta name="author" content="Adtile">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <link rel="stylesheet" href="assets/css/nav.css">
    <link rel="stylesheet" href="assets/css/housesBusq.css">
    <link rel="stylesheet" href="assets/css/housecontract.css">
</head>
<header>
    <?php require 'views/login/nav.php'; ?>
</header>

<body>
    <main class="app-content">
        <div class="page-error tile">
            <h1>🟢 Casas Disponibles</h1>

        </div>

        <div aria-hidden="false" style="min-height: calc(100vh - 80px);">
            <div>
                <div aria-hidden="false" class="_1rxomnvc" id="search-results-container">
                    <div itemprop="itemList" itemscope="" itemtype="http://schema.org/ItemList"
                        data-container-name="explore" class="_19qnt1y">
                        <div class="_1gw6tte">
                            <div class="_1tukcbvt" style="background-color: transparent;">
                                <div>
                                    <div></div>
                                    <div></div>
                                    <div>
                                        <div class="_120osvx">
                                            <div class="_1i1hiso" id="_1i1hiso">
                                                <div class="_1kmzzkf">
                                                    <div class="_jve3un">
                                                        <div>
                                                            <div class="_fcpquh"><span aria-busy="true"
                                                                    style="display: block; height: auto; width: 100%; background-color: white; border-radius: 12px;"><span
                                                                        class="_8kplbn"
                                                                        style="animation-play-state: running; aspect-ratio: 100 / 100; height: 100%; width: 100%; border-radius: 12px;"></span></span>
                                                            </div>
                                                            <div class="_zjunba"><span aria-busy="true"
                                                                    style="display: block; height: 20px; width: 50%; background-color: white; border-radius: 10px;"><span
                                                                        class="_8kplbn"
                                                                        style="height: 100%; width: 100%; border-radius: 10px;"></span></span><span
                                                                    aria-busy="true"
                                                                    style="display: block; height: 20px; width: 25%; background-color: white; border-radius: 10px;"><span
                                                                        class="_8kplbn"
                                                                        style="height: 100%; width: 100%; border-radius: 10px;"></span></span>
                                                            </div>
                                                            <div class="_1asxs4e"><span aria-busy="true"
                                                                    style="display: block; height: 20px; width: 35%; background-color: white; border-radius: 10px;"><span
                                                                        class="_8kplbn"
                                                                        style="height: 100%; width: 100%; border-radius: 10px;"></span></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="_1e541ba5">
                                                        <div>
                                                            <div>
                                                                <div aria-labelledby="title_38305346" role="group"
                                                                    class="_e296pg"><a aria-labelledby="title_38305346"
                                                                        href="/rooms/38305346?category_tag=Tag%3A8188&amp;adults=1&amp;children=0&amp;infants=0&amp;check_in=2021-12-31&amp;check_out=2022-01-07&amp;previous_page_section_name=1000&amp;federated_search_id=5630a0f3-9b92-48c0-b4aa-b796e6ea58c6"
                                                                        rel="noopener noreferrer"
                                                                        target="listing_38305346" class="_1jhvjuo"></a>
                                                                    <div class="_3x2xkx">

                                                                        <!--image slider start-->
                                                                        <div class="slider">
                                                                            <div class="slides">
                                                                                <!--radio buttons start-->
                                                                                <input type="radio" name="radio-btn"
                                                                                    id="radio1">
                                                                                <input type="radio" name="radio-btn"
                                                                                    id="radio2">
                                                                                <input type="radio" name="radio-btn"
                                                                                    id="radio3">
                                                                                <input type="radio" name="radio-btn"
                                                                                    id="radio4">
                                                                                <!--radio buttons end-->
                                                                                <!--slide images start-->
                                                                                <div class="slide first">
                                                                                    <img src="assets/image/anfitriones/2000/img1.jpg"
                                                                                        alt="">
                                                                                </div>
                                                                                <div class="slide">
                                                                                    <img src="assets/image/anfitriones/2000/img2.jpg"
                                                                                        alt="">
                                                                                </div>
                                                                                <div class="slide">
                                                                                    <img src="assets/image/anfitriones/2000/img3.jpg"
                                                                                        alt="">
                                                                                </div>
                                                                                <div class="slide">
                                                                                    <img src="assets/image/anfitriones/2000/img4.jpg"
                                                                                        alt="">
                                                                                </div>
                                                                                <!--slide images end-->
                                                                            </div>
                                                                            <!--manual navigation start-->
                                                                            <div class="navigation-manual">
                                                                                <label for="radio1"
                                                                                    class="manual-btn"></label>
                                                                                <label for="radio2"
                                                                                    class="manual-btn"></label>
                                                                                <label for="radio3"
                                                                                    class="manual-btn"></label>
                                                                                <label for="radio4"
                                                                                    class="manual-btn"></label>
                                                                            </div>
                                                                            <!--manual navigation end-->
                                                                        </div>
                                                                        <!--image slider end-->
                                                                        <div class="_zjunba">
                                                                            <div>
                                                                                <div class="_pgfqnw">
                                                                                    <div class="_5kaapu"><span
                                                                                            class="_1spi1ps9"
                                                                                            id="title_38305346"
                                                                                            style="line-height: 20px; max-height: 20px; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical;">East
                                                                                            Point, Georgia</span></div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="_1qfyimw">
                                                                                <div
                                                                                    style="--pricing-guest-display-price-alignment:flex-end; --pricing-guest-display-price-flex-wrap:wrap; --pricing-guest-primary-line-font-size:16px; --pricing-guest-primary-line-line-height:20px; --pricing-guest-primary-line-unit-price-font-weight:400; --pricing-guest-primary-line-trialing-content-font-size:14px; --pricing-guest-secondary-line-font-size:14px; --pricing-guest-secondary-line-line-height:18px; --pricing-guest-secondary-line-color:#717171; --pricing-guest-explanation-disclaimer-font-size:14px; --pricing-guest-explanation-disclaimer-line-height:18px; --pricing-guest-primary-line-strikethrough-price-font-weight:400; --pricing-guest-primary-line-qualifier-font-size:16px; --pricing-guest-primary-line-qualifier-line-height:20px;">
                                                                                    <div class="_ati8ih">
                                                                                        <div class="_1n700sq">
                                                                                            <div class="_1jo4hgw"
                                                                                                aria-hidden="true"><span
                                                                                                    class="_tyxjp1">$10,177
                                                                                                    MXN</span><span
                                                                                                    class="_1vylq8i">&nbsp;/
                                                                                                    noche</span></div>
                                                                                            <span
                                                                                                class="a8jt5op dir dir-ltr">$10,177
                                                                                                MXN por noche</span>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="_zjunba">
                                                                            <div>
                                                                                <div class="_15eotbx">A 2,149&nbsp;km de
                                                                                    distancia
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
            // en el objeto “datos” tenemos los datos que vamos a enviar al servidor
            // en este ejemplo tenemos cuatro datos; la accion, ubicación, fechas de llegada y salida. 
            var datos = {
                action: "<?php echo $_GET["action"]; ?>",
                ubicacion: "<?php echo $_GET["ubicacion"]; ?>",
                llegada: "<?php echo $_GET["llegada"]; ?>",
                salida: "<?php echo $_GET["salida"]; ?>"
            };
            // en el objeto init tenemos los parámetros de la petición AJAX
            var init = {
                // el método de envío de la información será POST
                method: "POST",
                headers: { // cabeceras HTTP
                    // vamos a enviar los datos en formato JSON
                    'Content-Type': 'application/json'
                },
                // el cuerpo de la petición es una cadena de texto
                // con los datos en formato JSON
                body: JSON.stringify(datos) // convertimos el objeto a texto
            };
            // realizamos la petición AJAX usando fetch
            // el primer parámetro es el recurso del servidor al que queremos acceder
            // en este ejemplo, es un fichero php llamado busqRapids.php que se encuentra
            // dentro de la carpeta de Controllers.
            // el segundo parámetro es el objeto init con la información sobre los
            // datos que queremos enviar.

            var dataHouse = [];

            async function getDataHouse() {
                dataHouse = await fetch('http://localhost:80/Casas01/houses/busqRapids', init)
                    .then(res => res.json())
                    .then(json => json);
                HouseGallery(dataHouse);
            }
            getDataHouse();

            function HouseGallery(dataHouse) {
                var items = [];
                dataHouse.forEach(item => {
                    items.push(item.idCasa);
                });
                var dat = {
                    casas: items
                };
                var ini = {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(dat) // convertimos el objeto a texto
                };
                var dataGallery = [];

                async function getDataGallery() {
                    dataGallery = await fetch('http://localhost:80/Casas01/houses/busqGallery', ini)
                        .then(res => res.json())
                        .then(json => json);
                    renderDataHouse(dataHouse, dataGallery);
                }
                getDataGallery();
            }

            function renderDataHouse(dataHouse, dataGallery) {

                dataHouse.forEach(
                    item => {

                        item.img1 = "1";
                        item.img2 = "2";
                        item.img3 = "3";
                        item.img4 = "4";
                    }
                );
                dataHouse.forEach(
                    item => {

                        dataGallery.forEach(
                            items => {
                                if (items.idCasa == item.idCasa) {
                                    if (items.idFotografia == "1") {
                                        item.img1 = items.img_Url;
                                    }
                                    if (items.idFotografia == "2") {
                                        item.img2 = items.img_Url;
                                    }
                                    if (items.idFotografia == "3") {
                                        item.img3 = items.img_Url;
                                    }
                                    if (items.idFotografia == "4") {
                                        item.img4 = items.img_Url;
                                    }
                                }

                            }
                        );

                        console.log(item);
                    }
                );





                var databodyG = document.querySelector('#_1i1hiso');

                databodyG.innerHTML = '';

                dataHouse.forEach(item => {

                    databodyG.innerHTML +=
                        `
                            <div class="_1kmzzkf">
                                                <div class="_jve3un">
                                                    <div>
                                                        <div class="_fcpquh"><span aria-busy="true"
                                                                style="display: block; height: auto; width: 100%; background-color: white; border-radius: 12px;"><span
                                                                    class="_8kplbn"
                                                                    style="animation-play-state: running; aspect-ratio: 100 / 100; height: 100%; width: 100%; border-radius: 12px;"></span></span>
                                                        </div>
                                                        <div class="_zjunba"><span aria-busy="true"
                                                                style="display: block; height: 20px; width: 50%; background-color: white; border-radius: 10px;"><span
                                                                    class="_8kplbn"
                                                                    style="height: 100%; width: 100%; border-radius: 10px;"></span></span><span
                                                                aria-busy="true"
                                                                style="display: block; height: 20px; width: 25%; background-color: white; border-radius: 10px;"><span
                                                                    class="_8kplbn"
                                                                    style="height: 100%; width: 100%; border-radius: 10px;"></span></span>
                                                        </div>
                                                        <div class="_1asxs4e"><span aria-busy="true"
                                                                style="display: block; height: 20px; width: 35%; background-color: white; border-radius: 10px;"><span
                                                                    class="_8kplbn"
                                                                    style="height: 100%; width: 100%; border-radius: 10px;"></span></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="_1e541ba5">
                                                    <div>
                                                        <div>
                                                            <div aria-labelledby="title_38305346" role="group"
                                                                class="_e296pg"><a aria-labelledby="title_38305346"
                                                                    href="<?php echo constant('URL'); ?>/housepage?idCasa=${item.idCasa}"
                                                                    rel="noopener noreferrer" target="listing_38305346"
                                                                    class="_1jhvjuo"></a>
                                                                <div class="_3x2xkx">

                                                                    <!--image slider start-->
                                                                    <div class="slider">
                                                                        <div class="slides">
                                                                            <!--radio buttons start-->
                                                                            
                                                                            <input type="radio" name="radio-btn"
                                                                                id="radio${item.idCasa}1" class="radio1">
                                                                            <input type="radio" name="radio-btn"
                                                                                id="radio${item.idCasa}2" class="radio2">
                                                                            <input type="radio" name="radio-btn"
                                                                                id="radio${item.idCasa}3" class="radio3">
                                                                            <input type="radio" name="radio-btn"
                                                                                id="radio${item.idCasa}4" class="radio4">
                                                                            <!--radio buttons end-->
                                                                            <!--slide images start-->
                                                                            <div class="slide first">
                                                                                <img src="assets/image/anfitriones/${item.idCasa}/${item.img1}"
                                                                                    alt="">
                                                                            </div>
                                                                            <div class="slide">
                                                                                <img src="assets/image/anfitriones/${item.idCasa}/${item.img2}"
                                                                                    alt="">
                                                                            </div>
                                                                            <div class="slide">
                                                                                <img src="assets/image/anfitriones/${item.idCasa}/${item.img3}"
                                                                                    alt="">
                                                                            </div>
                                                                            <div class="slide">
                                                                                <img src="assets/image/anfitriones/${item.idCasa}/${item.img4}"
                                                                                    alt="">
                                                                            </div>
                                                                            <!--slide images end-->
                                                                        </div>
                                                                        <!--manual navigation start-->
                                                                        <div class="navigation-manual">
                                                                            <label for="radio${item.idCasa}1"
                                                                                class="manual-btn"></label>
                                                                            <label for="radio${item.idCasa}2"
                                                                                class="manual-btn"></label>
                                                                            <label for="radio${item.idCasa}3"
                                                                                class="manual-btn"></label>
                                                                            <label for="radio${item.idCasa}4"
                                                                                class="manual-btn"></label>
                                                                        </div>
                                                                        <!--manual navigation end-->
                                                                    </div>
                                                                    <!--image slider end-->
                                                                    
                                                                    <div class="_zjunba">
                                                                        <div>
                                                                            <div class="_pgfqnw">
                                                                                <div class="_5kaapu"><span
                                                                                        class="_1spi1ps9"
                                                                                        id="title_38305346"
                                                                                        style="line-height: 20px; max-height: 20px; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical;"><b>${item.casa_Nombre}</b></span></div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="_1qfyimw">
                                                                            <div
                                                                                style="--pricing-guest-display-price-alignment:flex-end; --pricing-guest-display-price-flex-wrap:wrap; --pricing-guest-primary-line-font-size:16px; --pricing-guest-primary-line-line-height:20px; --pricing-guest-primary-line-unit-price-font-weight:400; --pricing-guest-primary-line-trialing-content-font-size:14px; --pricing-guest-secondary-line-font-size:14px; --pricing-guest-secondary-line-line-height:18px; --pricing-guest-secondary-line-color:#717171; --pricing-guest-explanation-disclaimer-font-size:14px; --pricing-guest-explanation-disclaimer-line-height:18px; --pricing-guest-primary-line-strikethrough-price-font-weight:400; --pricing-guest-primary-line-qualifier-font-size:16px; --pricing-guest-primary-line-qualifier-line-height:20px;">
                                                                                <div class="_ati8ih">
                                                                                    <div class="_1n700sq">
                                                                                        <div class="_1jo4hgw" aria-hidden="true"><span class="_tyxjp1">$${item.casa_Renta} MXN</span><span class="_1vylq8i">&nbsp;/ noche</span></div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="_zjunba">
                                                                        <div>
                                                                            <div class="_15eotbx">En ${item.casa_Region}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                            `;
                });
            }
            </script>



    </main>
</body>

</html>